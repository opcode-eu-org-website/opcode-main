% Copyright (c) 2017-2020 Matematyka dla Ciekawych Åšwiata (http://ciekawi.icm.edu.pl/)
% Copyright (c) 2017-2020 Robert Ryszard Paciorek <rrp@opcode.eu.org>
% 
% MIT License
% 
% Permission is hereby granted, free of charge, to any person obtaining a copy
% of this software and associated documentation files (the "Software"), to deal
% in the Software without restriction, including without limitation the rights
% to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
% copies of the Software, and to permit persons to whom the Software is
% furnished to do so, subject to the following conditions:
% 
% The above copyright notice and this permission notice shall be included in all
% copies or substantial portions of the Software.
% 
% THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
% IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
% FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
% AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
% LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
% OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
% SOFTWARE.

% BEGIN: UÅ¼ytkownicy, uprawnienia i procesy
\section{UÅ¼ytkownicy, uprawnienia i procesy}

%Systemy ,,unixowe'' tworzone byÅ‚y jako wielo-uÅ¼ytkownikowe i wielo-procesowe, w wyniku tego posiadajÄ… 

\subsection{Uprawnienia do plikÃ³w}
Podstawowe unixowe uprawnienia do plikÃ³w skÅ‚adajÄ… siÄ™ z trzech czÅ‚onÃ³w: uprawnienia dla wÅ‚aÅ›ciciela (u), grupy (g) i pozostaÅ‚ych uÅ¼ytkownikÃ³w (o).
W kaÅ¼dym z czÅ‚onÃ³w mogÄ… byÄ‡ przyznane uprawnienia do czytania (r), pisania (w) i wykonywania (x); w odniesieniu do plikÃ³w jest to intuicyjne (uprawnienie do wykonywania jest potrzebne do uruchomienia programÃ³w), natomiast w stosunku do katalogÃ³w wyglÄ…da to nastÄ™pujÄ…co: uprawnienia do czytania pozwalajÄ… na listowanie zawartoÅ›ci, do wykonania pozwalajÄ… na dostÄ™p, do zawartoÅ›ci katalogu (wejÅ›cia do niego) do pisania na tworzenie nowych obiektÃ³w wewnÄ…trz niego i zmienianie nazw istniejÄ…cych.

Rozszerzeniem podstawowych uprawnieÅ„ opisanych powyÅ¼ej jest mechanizm Filesystem Access Control List (ACL, fACL).\\
Jest on opcjonalnym mechanizmem ktÃ³ry (na wspierajÄ…cych go systemach plikÃ³w) pozwala na definiowanie indywidualnych uprawnieÅ„ do pliku dla poszczegÃ³lnych uÅ¼ytkownikÃ³w i grup â€“ plik ma nadal swojego wÅ‚aÅ›ciciela, grupÄ™ i wszystkich pozostaÅ‚ych, ale przed prawami dla "others" wchodzÄ… prawa uÅ¼ytkownikÃ³w i grup definiowanych w ACL. Wypadkowe prawa obliczane sÄ… jako suma wynikÅ‚a z praw uÅ¼ytkownika i grup do ktÃ³rych naleÅ¼y.\\
ACL pozwala ponadto definiowaÄ‡ uprawnienia domyÅ›lne dla nowo powstaÅ‚ych plikÃ³w w katalogu (sÄ… one opcjÄ… katalogu).

Wszystkie poniÅ¼sze komendy przyjmujÄ… opcjÄ™ \texttt{-R} powodujÄ…cÄ… rekursywne wykonywanie zmian na drzewku katalogÃ³w/plikÃ³w rozpoczynajÄ…cym siÄ™ w podanej Å›cieÅ¼ce.
\begin{itemize}
	\item \Verb{chown [opcje] wÅ‚aÅ›ciciel Å›cieÅ¼ka}
		zmiana wÅ‚aÅ›ciciela pliku
	\item \Verb{chgrp [opcje] grupa Å›cieÅ¼ka}
		zmiana grupy do ktÃ³rej naleÅ¼y plik pliku
	\item \Verb{chmod [opcje] uprawnienia Å›cieÅ¼ka}
		zmiana prawa dostÄ™pu do pliku(Ã³w)
	
	\item \Verb{getfacl [opcje] [Å›cieÅ¼ka]}
		odczyt uprawnieÅ„ zwiÄ…zanych z listami kontroli dostÄ™pu fACL
	\item \Verb{setfacl [opcje] [Å›cieÅ¼ka]}
		ustawianie uprawnieÅ„ zwiÄ…zanych z listami kontroli dostÄ™pu fACL
\end{itemize}

\noindent{\Symbola ğŸ¤”} Dodatkowo naleÅ¼y wspomnieÄ‡ teÅ¼ o poleceniach takich jak:
\begin{itemize}
	\item \Verb{lsattr} / \Verb{chattr}
		wyÅ›wietla / modyfikuje atrybuty plikÃ³w zwiÄ…zanych z systemem plikÃ³w (np. zabrania jakiejkolwiek modyfikacji pliku)
	\item \Verb{getcap} / \Verb{setcap}
		wyÅ›wietla / modyfikuje atrybuty plikÃ³w zwiÄ…zanych z wÅ‚aÅ›ciwoÅ›ciami jÄ…dra (zasadniczo zwiÄ™kszonymi uprawnieniami programÃ³w je posiadajÄ…cych, ale bardziej ograniczonymi niÅ¼ wykonanie na prawach root przez SUID)
\end{itemize}

\subsection{UÅ¼ytkownicy}
\begin{itemize}
	\item \Verb{id [uÅ¼ytkownik]}
		informacja o uÅ¼ytkowniku (m.in. grupy do ktÃ³rych naleÅ¼y)
	\item \Verb{whoami}
		informacja o aktualnym uÅ¼ytkowniku
	\item \Verb{w lub who}
		informacja o zalogowanych uÅ¼ytkownikach
	
	\item \Verb{passwd [uÅ¼ytkownik]}
		zmiana hasÅ‚a
		
	\item \Verb{su [uÅ¼ytkownik]}
		przeÅ‚Ä…cza uÅ¼ytkownika (aby przeÅ‚Ä…czony uÅ¼ytkownik miaÅ‚ dostÄ™p do "naszego" x serwera wczeÅ›niej wydajemy \texttt{xhost LOCAL:uÅ¼ytkownik})
	\item \Verb{sudo}
		program pozwalajÄ…cy na wykonywanie uprzywilejowanych komend przez wyznaczonych uÅ¼ytkownikÃ³w
\end{itemize}

\subsection{Procesy i zasoby}
\begin{itemize}
	\item \Verb{ps [opcje]}
		wyÅ›wietla aktualnie dziaÅ‚ajÄ…ce procesy i informacje o nich\\
			np. kombinacja opcji \texttt{-Af} powoduje wyÅ›wietlenie wszystkich procesÃ³w w rozszerzonym formacie wypisywania
		
	\item \Verb{top}
		monitorowanie procesÃ³w obciÄ…Å¼ajÄ…cych CPU, pamiÄ™Ä‡, itd
	\item \Verb{iotop}
		monitorowanie procesÃ³w obciÄ…Å¼ajÄ…cych I/O
	
	\item \Verb{kill [opcje] pid}
		przesyÅ‚a sygnaÅ‚ do procesÃ³w o podanych PID
	\item \Verb{killall [opcje] nazwa}
		przesyÅ‚a sygnaÅ‚ do procesÃ³w o pasujÄ…cej nazwie
\end{itemize}

\begin{ProTip}[breakable]{kill i zabijanie procesu}
Polecenie kill domyÅ›lnie wysyÅ‚a sygnaÅ‚ SIGTERM, ktÃ³ry jest proÅ›bÄ… o zakoÅ„czenie procesu (proces moÅ¼e jÄ… uszanowaÄ‡ lub nie, np. zignorowaÄ‡). WiÄ™c sam kill nie zabija procesu.

Wiele sygnaÅ‚Ã³w moÅ¼e zostaÄ‡ przechwyconych i obsÅ‚uÅ¼onych (zignorowanych) przez proces do ktÃ³rego sÄ… adresowane. IstniejÄ… takÅ¼e sygnaÅ‚y, ktÃ³re nie mogÄ… zostaÄ‡ obsÅ‚uÅ¼one bÄ…dÅº zignorowane sÄ… to m.in.:
	SIGKILL (zakoÅ„czenie procesu bez dania mu jakiejkolwiek szansy zrobienia czegoÅ› na â€do widzeniaâ€, wysyÅ‚any przez \Verb#kill -9#),
	SIGSTOP (wstrzymanie procesu).
\end{ProTip}

\begin{ProTip}[breakable]{Ctrl+C / Ctrl+Z / Ctrl+D}
\textbf{Ctrl+C} wysyÅ‚a sygnaÅ‚ SIGINT do procesu zajmujÄ…cego terminal na ktÃ³rym zostaÅ‚ on wprowadzony. SygnaÅ‚ ten jest proÅ›bÄ… o zakoÅ„czenie procesu, ktÃ³rÄ… proces moÅ¼e uszanowaÄ‡ lub nie (np. moÅ¼e caÅ‚kiem zignorowaÄ‡ lub poprosiÄ‡ o potwierdzenie). Jest on podobny do SIGTERM, jednak jest innym sygnaÅ‚em i moÅ¼e byÄ‡ inaczej obsÅ‚uÅ¼ony (np. w SIGTERM nie ma wiÄ™kszego sensu pytaÄ‡ o potwierdzenie).

\vspace{6pt}\textbf{Ctrl+Z} wysyÅ‚a sygnaÅ‚ SIGTSTP do procesu zajmujÄ…cego terminal na ktÃ³rym zostaÅ‚ on wprowadzony. SygnaÅ‚ ten jest proÅ›bÄ… o wstrzymanie procesu i oddanie terminala, proÅ›ba ta moÅ¼e byÄ‡ zignorowana przez proces. Proces przerwany w ten sposÃ³b moÅ¼e byÄ‡ wznowiony poleceniem \Verb#fg# (ktÃ³re wznowi go jako pierwszoplanowy â€“ okupujÄ…cy terminal) lub \Verb#bg# (ktÃ³re wznowi go jako jako proces w tle â€“ oddajÄ…c terminal, przodkowi ktÃ³ry go posiadaÅ‚ wczeÅ›niej).

\vspace{6pt}\textbf{Ctrl+D} nie wysyÅ‚a Å¼adnego sygnaÅ‚u, dziaÅ‚a tylko gdy proces czyta dane z terminala (podÅ‚Ä…czonego zazwyczaj do jego standardowego wejÅ›cia). WysyÅ‚a on do terminala znak EOT (End-of-Transmission), w efekcie czego:
\begin{itemize}
	\item (jeÅ¼eli bufor wejÅ›ciowy jest niepusty) terminal wypycha bufor wejÅ›ciowy do programu (tak jak po wprowadzeniu nowej linii), albo
	\item (jeÅ¼eli nie ma znakÃ³w w buforze) terminal zamyka strumieÅ„ wprowadzanych danych do programu
\end{itemize}
Program nie otrzymuje w strumieniu znaku EOT (jest on przechwycony przez terminal).
ZamkniÄ™cie strumienia wejÅ›ciowego na ogÃ³Å‚ prowadzi takÅ¼e do zakoÅ„czenia dziaÅ‚ania programu, jednak (w odrÃ³Å¼nieniu od Ctrl-C) pozwala programowi na normalne przetworzenie wprowadzonych danych.
\end{ProTip}

\begin{ProTip}[breakable]{Ctrl+S / Ctrl+Q}
\textbf{Ctrl+S} wstrzymuje przewijanie (odÅ›wieÅ¼anie) terminala, aby wznowiÄ‡ naleÅ¼y uÅ¼yÄ‡ \textbf{Ctrl+Q}.
\end{ProTip}
% END: UÅ¼ytkownicy, uprawnienia i procesy

% BEGIN: Planowanie zadaÅ„
\subsection{Planowanie zadaÅ„}
Typowo system zapewnia usÅ‚ugÄ™ uruchamiania zadaÅ„ o zadanym czasie. Z usÅ‚ugi tej moÅ¼na skorzystaÄ‡ przy pomocy poleceÅ„:
\begin{itemize}
	\item \Verb{crontab} pozwala oglÄ…daÄ‡ i edytowaÄ‡ tablice zaplanowanych zadaÅ„ cyklicznych (dla cron'a)
	\item \Verb{at} pozwala jednorazowo zaplanowaÄ‡ zadanie
\end{itemize}
	Pliki konfiguracyjne crona / obsÅ‚ugiwane crontab-em majÄ… postaÄ‡: \texttt{minuty godzina  dzienMiesiaca miesiac dzienTygodnia polecenie}.
	Wpis oznacza Å¼e polecenie ma zostaÄ‡ wykonane jeÅ¼eli wszystkie warunki bÄ™dÄ… speÅ‚nione, jeÅ¼eli jakiÅ› warunek nie jest nam potrzebny moÅ¼na uÅ¼yÄ‡ gwiazdki \texttt{*},
	z kolei \texttt{*/n} oznacza wykonywanie jeÅ¼eli dana wartoÅ›Ä‡ jest podzielna przez n. Np.:
		\texttt{*/20 3  * * 1 ls} oznacza wykonanie komendy ls w kaÅ¼dy poniedziaÅ‚ek o godzinie 3:00 3:20 i 3:40
	
	Standardowe wyjÅ›cie, wyjÅ›cie bÅ‚Ä™du oraz powiadomienie o niezerowym kodzie powrotu domyÅ›lnie sÄ… wysyÅ‚ane na lokalny adres mailowy uÅ¼ytkownika bÄ™dÄ…cego wÅ‚aÅ›cicielem danego contaba.
	Niekiedy dostÄ™pny jest takÅ¼e \texttt{anacron} pozwalajÄ…cy na mniej precyzyjne planowanie zadaÅ„.
% END: Planowanie zadaÅ„
